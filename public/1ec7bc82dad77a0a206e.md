---
title: ã€SwiftUIã€‘MenuBarExtraä½¿ã£ã¦ã¿ãŸ
tags:
  - iOS
  - Swift
  - SwiftUI
  - MenuBar
  - MenuBarExtra
private: false
updated_at: '2022-10-26T17:44:39+09:00'
id: 1ec7bc82dad77a0a206e
organization_url_name: null
slide: false
ignorePublish: false
---
# ã¯ã˜ã‚ã«
ä»¥å‰ã€SwiftUIã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã—ãŸã€‚

https://qiita.com/SNQ-2001/items/7e8ac52e9e8726228806

ã“ã®æ™‚ã¯å…¬å¼ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã®ã§ã€NSHostingControllerã¨NSPopoverã‚’ä½¿ç”¨ã—ã¦ç„¡ç†ã‚„ã‚Šä½œã£ã¦ã„ã¾ã—ãŸã€‚

ã—ã‹ã—ï¼ï¼WWDC22ã§`MenuBarExtra`ã¨ã„ã†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªã‚’SwiftUIã§ä½œã‚‹ç”¨ã®æ©Ÿèƒ½ãŒç™ºè¡¨ã•ã‚Œã¾ã—ãŸï¼ï¼

macOS13ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸã®ã§æ—©é€Ÿä½¿ã£ã¦ã¿ã¾ã—ãŸï¼

ä»¥å‰ã®å®Ÿè£…æ–¹æ³•ã¨æ¯”è¼ƒã—ãªãŒã‚‰ç´¹ä»‹ã§ããŸã‚‰ã¨æ€ã„ã¾ã™ï¼

# ä»¥å‰ã®å®Ÿè£…æ–¹æ³•
```swift
import SwiftUI

@main
struct SwiftUI_MenuBar_DemoApp: App {
    @NSApplicationDelegateAdaptor(AppDelegate.self) var delegate
    var body: some Scene {
        Settings { }
    }
}

class AppDelegate: NSObject, NSApplicationDelegate {
    var statusBarItem: NSStatusItem!
    var popover = NSPopover()
    func applicationDidFinishLaunching(_ notification: Notification) {
        popover.behavior = .transient
        popover.contentViewController = NSHostingController(rootView: ContentView())
        self.statusBarItem = NSStatusBar.system.statusItem(withLength: CGFloat(NSStatusItem.variableLength))
        guard let button = self.statusBarItem.button else { return }
        // ã‚¢ã‚¤ã‚³ãƒ³ã®è¨­å®š
        button.image = NSImage(systemSymbolName: "camera.macro", accessibilityDescription: nil)
        // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®è¨­å®š
        button.action = #selector(menuButtonAction(sender:))
    }
    @objc func menuButtonAction(sender: AnyObject) {
        guard let button = self.statusBarItem.button else { return }
        if self.popover.isShown {
            self.popover.performClose(sender)
        } else {
            // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤º
            self.popover.show(relativeTo: button.bounds, of: button, preferredEdge: NSRectEdge.minY)
            // ä»–ã®ä½ç½®ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨æ¶ˆãˆã‚‹
            self.popover.contentViewController?.view.window?.makeKey()
        }
    }
}
```

# macOS13ã‹ã‚‰ã®å®Ÿè£…æ–¹æ³•
ã“ã‚Œã ã‘ï¼ï¼ç°¡å˜ï¼ï¼ï¼
```swift
import SwiftUI

@main
struct MenuBarApp: App {
    var body: some Scene {
        MenuBarExtra {
            ContentView()
        } label: {
            Image(nsImage: NSImage(named: "menubar"))
        }
        .menuBarExtraStyle(.window)
    }
}
```

:::note warn
**æ³¨æ„1**
`MenuBarExtra`ã®labelã«Imageã‚’è¨­å®šã™ã‚‹å ´åˆã¯`NSImage`ã§ãªã„ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã§ã®åˆ‡ã‚Šæ›¿ãˆãŒã•ã‚Œã¾ã›ã‚“
:::

:::note warn
**æ³¨æ„2**
`.menuBarExtraStyle(.window)`
ã“ã‚ŒãŒãªã„ã¨`ContentView`ã®ã‚µã‚¤ã‚ºã§è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“
:::

# ãŠã‚ã‚Š
SwiftUIã§ã§ãã‚‹ã“ã¨ãŒå¢—ãˆã‚‹ã¨å¬‰ã—ã„ã§ã™ğŸ˜†

MenuBarExtraã‚’ä½¿ã£ãŸãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªã§ã™ï¼
ã‚¹ã‚¿ãƒ¼ãã ã•ã„ï¼ï¼ï¼ï¼

https://github.com/SNQ-2001/github-contributions-menubar-macos/tree/1.1.0
