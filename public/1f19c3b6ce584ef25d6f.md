---
title: ã€AdMobã€‘iPadã§AdMobåºƒå‘Šã‚’è¡¨ç¤ºã™ã‚‹å ´åˆã«ç™ºç”Ÿã™ã‚‹ã‚¨ãƒ©ãƒ¼
tags:
  - iPad
  - iOS
  - adMob
  - Swift
private: false
updated_at: '2022-11-09T22:57:04+09:00'
id: 1f19c3b6ce584ef25d6f
organization_url_name: null
slide: false
ignorePublish: false
---
# ã¯ã˜ã‚ã«
ä»Šå›ã®å•é¡Œã¯ã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ã¿ã§ç™ºç”Ÿã—ã¾ã™ã€‚
å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆã‚„ãƒªãƒªãƒ¼ã‚¹ã‚¢ãƒ—ãƒªã§ã¯ç™ºç”Ÿã—ãªã„å•é¡Œãªã®ã§ã‚¨ãƒ©ãƒ¼ãŒæ°—ã«ãªã‚‰ãªã„æ–¹ã¯ã‚¹ãƒ«ãƒ¼ã§ã„ã„ã¨æ€ã„ã¾ã™ã€‚

ç§ã¯æ°—ã«ãªã£ãŸã®ã§å¯¾å¿œã—ã¾ã—ãŸ

# ã‚¨ãƒ©ãƒ¼
![ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2022-08-03 17.32.15.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1745371/dc13e708-51f0-3dd3-e26f-b471a3811e5f.png)
```
<Google> Invalid Request. The GADRequest scene property should be set for applications that support multi-scene. Treating the unset property as an error while in test mode.
```

# è§£æ±ºæ–¹æ³•
## ãƒãƒŠãƒ¼åºƒå‘Šã®å ´åˆ
ãƒãƒŠãƒ¼åºƒå‘Šã®è¡¨ç¤ºæ–¹æ³•è§£èª¬ã¯[ã“ã¡ã‚‰](https://qiita.com/SNQ-2001/items/9bf389475cb5995469a0)
```diff_swift
import SwiftUI
import GoogleMobileAds

struct BannerView: UIViewControllerRepresentable {
    func makeUIViewController(context: Context) -> UIViewController {
        let viewController = GADBannerViewController()
        return viewController
    }
    func updateUIViewController(_ uiViewController: UIViewController, context: Context) {
    }
}

class GADBannerViewController: UIViewController, GADBannerViewDelegate {
    var bannerView: GADBannerView!
    let adUnitID = "ca-app-pub-3940256099942544/2934735716"
    override func viewDidLoad() {
        super.viewDidLoad()

        bannerView = GADBannerView(adSize: GADAdSizeBanner)
        bannerView.adUnitID = adUnitID
        bannerView.rootViewController = self

+       let request = GADRequest()
+       request.scene = UIApplication.shared.connectedScenes.first(where: { $0.activationState == .foregroundActive }) as? UIWindowScene
+       bannerView.load(request)
-       bannerView.load(GADRequest())

        bannerView.delegate = self
        setAdView(bannerView)
    }
    func setAdView(_ view: GADBannerView) {
        bannerView = view
        self.view.addSubview(bannerView)
        bannerView.translatesAutoresizingMaskIntoConstraints = false
        let viewDictionary = ["_bannerView": bannerView!]
        self.view.addConstraints(
            NSLayoutConstraint.constraints(
                withVisualFormat: "H:|[_bannerView]|",
                options: NSLayoutConstraint.FormatOptions(rawValue: 0), metrics: nil, views: viewDictionary)
        )
        self.view.addConstraints(
            NSLayoutConstraint.constraints(
                withVisualFormat: "V:|[_bannerView]|",
                options: NSLayoutConstraint.FormatOptions(rawValue: 0), metrics: nil, views: viewDictionary)
        )
    }

    func bannerViewDidReceiveAd(_ bannerView: GADBannerView) {
      print("ğŸ: ãƒãƒŠãƒ¼åºƒå‘Šã‚’å—ä¿¡ã—ã¾ã—ãŸ")
    }

    func bannerView(_ bannerView: GADBannerView, didFailToReceiveAdWithError error: Error) {
      print("ğŸ˜­: ãƒãƒŠãƒ¼åºƒå‘Šã®å—ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ â†’ \(error.localizedDescription)")
    }
    func bannerViewDidRecordImpression(_ bannerView: GADBannerView) {
      print("ğŸŒ: ãƒãƒŠãƒ¼åºƒå‘Šã‚’è¡¨ç¤ºã—ã¾ã—ãŸ")
    }
}
```

## ãƒªãƒ¯ãƒ¼ãƒ‰åºƒå‘Šã®å ´åˆ
ãƒªãƒ¯ãƒ¼ãƒ‰åºƒå‘Šã®è¡¨ç¤ºæ–¹æ³•è§£èª¬ã¯[ã“ã¡ã‚‰](https://qiita.com/SNQ-2001/items/253173abefc6f90f86ea)
```diff_swift
import GoogleMobileAds

class Reward: NSObject, GADFullScreenContentDelegate, ObservableObject {
    @Published var rewardLoaded: Bool = false
    var rewardedAd: GADRewardedAd?

    override init() {
        super.init()
    }

    // ãƒªãƒ¯ãƒ¼ãƒ‰åºƒå‘Šã®èª­ã¿è¾¼ã¿
    func LoadReward() {
+       let request = GADRequest()
+       request.scene = UIApplication.shared.connectedScenes.first as? UIWindowScene
+       GADRewardedAd.load(withAdUnitID: "ca-app-pub-3940256099942544/1712485313", request: request) { (ad, error) in
-       GADRewardedAd.load(withAdUnitID: "ca-app-pub-3940256099942544/1712485313", request: GADRequest()) { (ad, error) in
            if let _ = error {
                print("ğŸ˜­: èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")
                self.rewardLoaded = false
                return
            }
            print("ğŸ˜: èª­ã¿è¾¼ã¿ã«æˆåŠŸã—ã¾ã—ãŸ")
            self.rewardLoaded = true
            self.rewardedAd = ad
            self.rewardedAd?.fullScreenContentDelegate = self
        }
    }

    // ãƒªãƒ¯ãƒ¼ãƒ‰åºƒå‘Šã®è¡¨ç¤º
    func ShowReward() {
        let root = UIApplication.shared.windows.first?.rootViewController
        if let ad = rewardedAd {
            ad.present(fromRootViewController: root!, userDidEarnRewardHandler: {
                print("ğŸ˜: å ±é…¬ã‚’ç²å¾—ã—ã¾ã—ãŸ")
                self.rewardLoaded = false
            })
        } else {
            print("ğŸ˜­: åºƒå‘Šã®æº–å‚™ãŒã§ãã¦ã„ã¾ã›ã‚“ã§ã—ãŸ")
            self.rewardLoaded = false
            self.LoadReward()
        }
    }
}
```

## ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã®å ´åˆ
ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã®è¡¨ç¤ºæ–¹æ³•è§£èª¬ã¯[ã“ã¡ã‚‰](https://qiita.com/SNQ-2001/items/5590a55324c39582a9ef)
```diff_swift
import GoogleMobileAds

class Interstitial: NSObject, GADFullScreenContentDelegate, ObservableObject {
    @Published var interstitialAdLoaded: Bool = false
    var InterstitialAd: GADInterstitialAd?

    override init() {
        super.init()
    }

    // ãƒªãƒ¯ãƒ¼ãƒ‰åºƒå‘Šã®èª­ã¿è¾¼ã¿
    func LoadInterstitial() {
+       let request = GADRequest()
+       request.scene = UIApplication.shared.connectedScenes.first as? UIWindowScene
+       GADInterstitialAd.load(withAdUnitID: "ca-app-pub-3940256099942544/4411468910", request: request) { (ad, error) in
-       GADInterstitialAd.load(withAdUnitID: "ca-app-pub-3940256099942544/4411468910", request: GADRequest()) { (ad, error) in
            if let _ = error {
                print("ğŸ˜­: èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")
                self.interstitialAdLoaded = false
                return
            }
            print("ğŸ˜: èª­ã¿è¾¼ã¿ã«æˆåŠŸã—ã¾ã—ãŸ")
            self.interstitialAdLoaded = true
            self.InterstitialAd = ad
            self.InterstitialAd?.fullScreenContentDelegate = self
        }
    }

    // ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã®è¡¨ç¤º
    func ShowInterstitial() {
        let root = UIApplication.shared.windows.first?.rootViewController
        if let ad = InterstitialAd {
            ad.present(fromRootViewController: root!)
            self.interstitialAdLoaded = false
        } else {
            print("ğŸ˜­: åºƒå‘Šã®æº–å‚™ãŒã§ãã¦ã„ã¾ã›ã‚“ã§ã—ãŸ")
            self.interstitialAdLoaded = false
            self.LoadInterstitial()
        }
    }
    // å¤±æ•—é€šçŸ¥
    func ad(_ ad: GADFullScreenPresentingAd, didFailToPresentFullScreenContentWithError error: Error) {
        print("ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã®è¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸ")
        self.interstitialAdLoaded = false
        self.LoadInterstitial()
    }

    // è¡¨ç¤ºé€šçŸ¥
    func adWillPresentFullScreenContent(_ ad: GADFullScreenPresentingAd) {
        print("ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã‚’è¡¨ç¤ºã—ã¾ã—ãŸ")
        self.interstitialAdLoaded = false
    }

    // ã‚¯ãƒ­ãƒ¼ã‚ºé€šçŸ¥
    func adDidDismissFullScreenContent(_ ad: GADFullScreenPresentingAd) {
        print("ã‚¤ãƒ³ã‚¿ãƒ¼ã‚¹ãƒ†ã‚£ã‚·ãƒ£ãƒ«åºƒå‘Šã‚’é–‰ã˜ã¾ã—ãŸ")
        self.interstitialAdLoaded = false
    }
}
```

# å‚è€ƒã«ã—ãŸã‚µã‚¤ãƒˆ
https://developers.google.com/admob/ios/multiscene?hl=ja#banner

https://zenn.dev/yorifuji/articles/swiftui-admob-ipad
